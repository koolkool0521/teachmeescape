<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shadow School: 악몽의 교실</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; font-family: 'Courier New', Courier, monospace; user-select: none; }
        
        #ui-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }
        
        #crosshair {
            position: absolute; top: 50%; left: 50%;
            width: 8px; height: 8px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 4px white;
        }

        #hud {
            position: absolute; top: 20px; left: 20px;
            color: #ff3333; font-size: 1.5rem; font-weight: bold;
            text-shadow: 2px 2px 0 #000;
        }
        #timer-box {
            position: absolute; top: 20px; right: 20px;
            color: #fff; font-size: 2rem; font-weight: bold;
            text-shadow: 0 0 10px red;
        }

        #interact-msg {
            position: absolute; top: 60%; left: 50%; transform: translate(-50%, -50%);
            color: #fff; font-size: 1.2rem; display: none; text-shadow: 1px 1px 2px black;
        }

        #quiz-modal {
            display: none; position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(20, 10, 5, 0.95);
            border: 4px solid #3e2723;
            padding: 20px; width: 700px;
            color: #d7ccc8; pointer-events: auto;
            text-align: center;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.8);
        }
        #quiz-modal h2 { margin-top: 0; color: #ff5555; border-bottom: 1px solid #5d4037; padding-bottom: 10px; }
        .quiz-btn {
            display: block; width: 100%; padding: 10px; margin: 5px 0;
            background: #3e2723; color: #d7ccc8; border: 1px solid #5d4037;
            cursor: pointer; text-align: left; font-weight: bold; font-size: 1.1rem;
        }
        .quiz-btn:hover { background: #5d4037; color: #fff; }

        #start-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #050505; color: #a00;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            z-index: 100; pointer-events: auto;
            background-image: repeating-linear-gradient(0deg, transparent, transparent 1px, #110000 1px, #110000 2px);
        }
        h1 { font-size: 4rem; text-shadow: 0 0 20px red; margin-bottom: 10px; font-weight: 900; }
        
        .select-group { margin: 15px 0; display: flex; gap: 10px; }
        select {
            padding: 10px; font-size: 1.2rem; background: #200; color: #f00; border: 1px solid #f00;
            font-family: inherit; font-weight: bold;
        }

        .btn-start {
            padding: 15px 40px; font-size: 2rem;
            background: #200; color: #f00; border: 2px solid #f00;
            cursor: pointer; margin-top: 20px;
            font-family: 'Courier New', Courier, monospace;
            font-weight: bold;
        }
        .btn-start:hover { background: #500; color: #fff; box-shadow: 0 0 20px red; }

        #gameover-screen {
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(20, 0, 0, 0.95); z-index: 200; pointer-events: auto;
            flex-direction: column; justify-content: center; align-items: center;
            color: white; text-align: center;
        }
        #gameover-msg { font-size: 5rem; color: red; font-family: 'Chiller', serif; text-shadow: 0 0 30px black; }
        
        .btn-group { display: flex; gap: 20px; margin-top: 30px; }
        .btn-retry { padding: 15px 30px; font-size: 1.5rem; background: #004400; color: #0f0; border: 2px solid #0f0; cursor: pointer; }
        .btn-giveup { padding: 15px 30px; font-size: 1.5rem; background: #440000; color: #f00; border: 2px solid #f00; cursor: pointer; }
        .btn-retry:hover { background: #006600; color: #fff; }
        .btn-giveup:hover { background: #660000; color: #fff; }

        .vignette {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, transparent 40%, black 140%);
            pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="ui-layer">
        <div class="vignette"></div>
        <div id="crosshair"></div>
        <div id="hud">
            교실: <span id="room-name">대기실</span><br>
            힌트: <span id="hint-count">0</span> / 10
        </div>
        <div id="timer-box">05:00</div>
        <div id="interact-msg">[클릭] 조사하기</div>
    </div>

    <div id="quiz-modal">
        <h2 id="quiz-subject">문제</h2>
        <p id="quiz-text" style="font-size:1.3rem; margin-bottom:20px; line-height: 1.4;"></p>
        <div id="quiz-options"></div>
        <p style="color:#a1887f; font-size:0.8rem; margin-top:10px;">⚠️ 문제를 푸는 동안에도 '그것'은 다가옵니다...</p>
    </div>

    <div id="start-screen">
        <h1>SHADOW SCHOOL</h1>
        <p style="color:#ccc; font-size:1.2rem;">학교의 악몽에서 탈출하라</p>
        
        <div class="select-group">
            <select id="grade-select">
                <option value="3">초등 3학년</option>
                <option value="4">초등 4학년</option>
                <option value="5">초등 5학년</option>
                <option value="6" selected>초등 6학년</option>
            </select>
            <select id="semester-select">
                <option value="1">1학기</option>
                <option value="2" selected>2학기</option>
            </select>
        </div>

        <p>각 교실에서 <b>10개의 힌트</b>를 모아야 합니다.</p>
        <p style="color:red; font-weight:bold;">검은 형체의 '붉은 가시'를 조심하세요.</p>
        <button class="btn-start" id="btn-init">게임 시작</button>
    </div>

    <div id="gameover-screen">
        <div id="gameover-msg">GAME OVER</div>
        <p id="death-reason" style="font-size:1.5rem;">...</p>
        <div class="btn-group">
            <button class="btn-retry" onclick="restartGame(false)">다시 시도</button>
            <button class="btn-giveup" onclick="restartGame(true)">포기하기 (지옥)</button>
        </div>
    </div>

    <!-- Import Maps -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/",
                "cannon-es": "https://unpkg.com/cannon-es@0.20.0/dist/cannon-es.js"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { PointerLockControls } from 'three/addons/controls/PointerLockControls.js';
        import * as CANNON from 'cannon-es';

        // --------------------------------------------------------------------------------------
        // [사용자 안내] 아래의 '텍스처 생성기'부터 'generateProblemBank 함수 끝'까지의 내용을
        // question_bank_generator.js 파일의 내용으로 '전체 덮어쓰기' 하세요.
        // 현재는 예시 데이터 1개씩만 들어있습니다.
        // --------------------------------------------------------------------------------------

        // --- 텍스처 생성기 ---
        function createWoodTexture(isDark = false) {
            const canvas = document.createElement('canvas');
            canvas.width = 512; canvas.height = 512;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = isDark ? '#3e2723' : '#5d4037';
            ctx.fillRect(0, 0, 512, 512);
            for (let i = 0; i < 2000; i++) {
                ctx.fillStyle = isDark ? 'rgba(0,0,0,0.1)' : 'rgba(0,0,0,0.05)';
                ctx.fillRect(Math.random() * 512, 0, Math.random() * 2 + 1, 512);
            }
            if (isDark) { 
                for(let i=0; i<500; i++) {
                    ctx.fillStyle = 'rgba(20, 20, 20, 0.3)';
                    const x = Math.random() * 512; const y = Math.random() * 512;
                    ctx.beginPath(); ctx.arc(x, y, Math.random() * 5, 0, Math.PI*2); ctx.fill();
                }
            }
            const texture = new THREE.CanvasTexture(canvas);
            texture.wrapS = THREE.RepeatWrapping; texture.wrapT = THREE.RepeatWrapping;
            return texture;
        }
        const woodTexture = createWoodTexture(false);
        const ceilingTexture = createWoodTexture(true);

        // ★ [데이터 삽입 위치] 이 staticDB를 question_bank_generator.js의 내용으로 교체하세요. ★
        const staticDB = {
    // ================= [수학] (각 20문제) =================
    "3-1-수학": [
        ["482 + 359의 계산 결과는?", ["841", "741", "831", "941"], 0],
        ["735 - 268의 계산 결과는?", ["467", "567", "477", "533"], 0],
        ["직각삼각형에 대한 설명으로 옳은 것은?", ["네 변이 있다", "모든 각이 둔각이다", "한 각이 직각이다", "세 변의 길이가 같다"], 2],
        ["나눗셈식 19 ÷ 5 = 3 ... 4 에서 나머지는?", ["19", "5", "3", "4"], 3],
        ["1분은 몇 초인가?", ["100초", "60초", "30초", "50초"], 1],
        ["길이의 단위 중 가장 큰 것은?", ["km", "m", "cm", "mm"], 0],
        ["3cm 5mm는 몇 mm인가?", ["350mm", "305mm", "35mm", "53mm"], 2],
        ["시각 읽기: 2시 50분에서 20분 후는?", ["3시 10분", "3시", "2시 70분", "3시 20분"], 0],
        ["8 × 7의 값은?", ["54", "56", "63", "49"], 1],
        ["정사각형의 특징으로 알맞은 것은?", ["네 각이 모두 직각이고 네 변의 길이가 같다", "마주 보는 변의 길이만 같다", "각의 크기가 모두 다르다", "변의 길이가 모두 다르다"], 0],
        ["직각은 몇 도인가?", ["100도", "45도", "90도", "180도"], 2],
        ["똑같이 나누어 주는 계산은 무엇인가?", ["덧셈", "뺄셈", "곱셈", "나눗셈"], 3],
        ["504 + 297의 어림셈 결과로 가장 가까운 것은?", ["700", "800", "900", "600"], 1],
        ["선분 ㄱㄴ과 선분 ㄴㄱ은 같은가?", ["같다", "다르다", "알 수 없다", "반대다"], 0],
        ["도형을 밀었을 때 변하는 것은?", ["모양", "크기", "위치", "색깔"], 2],
        ["34 × 2의 값은?", ["64", "68", "72", "60"], 1],
        ["나머지가 있는 나눗셈에서 나머지는 나누는 수보다?", ["작아야 한다", "커야 한다", "같아야 한다", "상관없다"], 0],
        ["1시간 30분은 몇 분인가?", ["90분", "130분", "100분", "80분"], 0],
        ["반직선 ㄱㄴ의 시작점은?", ["점 ㄱ", "점 ㄴ", "중간점", "없다"], 0],
        ["다음 중 평면도형이 아닌 것은?", ["삼각형", "원", "직육면체", "사각형"], 2]
    ],
    "3-2-수학": [
        ["원의 중심에서 원 위의 한 점을 이은 선분은?", ["지름", "원주", "반지름", "현"], 2],
        ["지름이 10cm인 원의 반지름은?", ["10cm", "20cm", "5cm", "15cm"], 2],
        ["분모가 같은 진분수의 덧셈 방법은?", ["분모끼리 더한다", "분자끼리 더한다", "분모와 분자를 모두 더한다", "뺄셈을 한다"], 1],
        ["대분수 1과 2/5를 가분수로 나타내면?", ["6/5", "7/5", "8/5", "3/5"], 1],
        ["들이의 단위가 아닌 것은?", ["L", "mL", "kg", "모두 맞음"], 2],
        ["1L는 몇 mL인가?", ["100mL", "1000mL", "10mL", "10000mL"], 1],
        ["무게의 단위 1kg은 몇 g인가?", ["100g", "1000g", "10g", "500g"], 1],
        ["23 × 40의 값은?", ["920", "820", "900", "800"], 0],
        ["84 ÷ 4의 몫은?", ["20", "22", "21", "24"], 2],
        ["나머지가 없는 나눗셈을 무엇이라 하는가?", ["나누어 떨어진다", "나머지 셈", "곱셈", "몫 셈"], 0],
        ["원 안의 가장 긴 선분은?", ["반지름", "지름", "원주", "중심"], 1],
        ["컴퍼스는 무엇을 그릴 때 사용하는가?", ["삼각형", "사각형", "원", "직선"], 2],
        ["분자보다 분모가 작거나 같은 분수는?", ["진분수", "가분수", "대분수", "소수"], 1],
        ["자연수와 진분수로 이루어진 분수는?", ["가분수", "대분수", "단위분수", "소수"], 1],
        ["들이를 어림할 때 쓰는 단위는?", ["약", "쯤", "정도", "모두 정답"], 3],
        ["3kg 500g + 1kg 200g 은?", ["4kg 300g", "4kg 700g", "2kg 300g", "5kg"], 1],
        ["곱셈식 45 × 12 에서 45 × 2의 값은?", ["90", "450", "540", "45"], 0],
        ["원의 중심은 원 안에 몇 개 있는가?", ["1개", "2개", "무수히 많다", "없다"], 0],
        ["그림그래프의 특징은?", ["정확한 수치를 알기 어렵다", "많고 적음을 쉽게 알 수 있다", "그리기 어렵다", "복잡하다"], 1],
        ["자료를 표로 나타내면 좋은 점은?", ["수량을 한눈에 알아보기 쉽다", "변화를 알기 쉽다", "비율을 알기 쉽다", "모양을 알기 쉽다"], 0]
    ],
    "4-1-수학": [
        ["1000이 10개인 수는?", ["1000", "10000(만)", "100000", "100"], 1],
        ["다섯 자리 수 '35672'에서 '3'이 나타내는 값은?", ["300", "3000", "30000", "3"], 2],
        ["각도기로 각을 잴 때 기준은?", ["각도기의 윗부분", "각도기의 중심과 밑금", "눈대중", "자"], 1],
        ["직각보다 작고 0도보다 큰 각은?", ["예각", "둔각", "평각", "직각"], 0],
        ["둔각삼각형의 설명으로 옳은 것은?", ["세 각이 모두 예각이다", "한 각이 둔각이다", "한 각이 직각이다", "세 변이 같다"], 1],
        ["삼각형의 세 각의 합은?", ["180도", "360도", "90도", "270도"], 0],
        ["사각형의 네 각의 합은?", ["180도", "360도", "90도", "720도"], 1],
        ["곱셈식 245 × 36의 계산 순서는?", ["30과 곱하고 6과 곱해 더한다", "그냥 더한다", "빼서 곱한다", "나눈다"], 0],
        ["나눗셈 784 ÷ 24의 몫을 어림할 때 좋은 수는?", ["20", "30", "40", "50"], 1],
        ["평면도형을 오른쪽으로 뒤집으면?", ["모양이 바뀐다", "왼쪽 오른쪽이 바뀐다", "위아래가 바뀐다", "그대로다"], 1],
        ["시계방향으로 90도 돌리기와 같은 것은?", ["시계 반대 방향으로 270도 돌리기", "시계 반대 방향으로 90도 돌리기", "180도 돌리기", "360도 돌리기"], 0],
        ["규칙 찾기: 3, 6, 9, 12, (?)", ["13", "14", "15", "16"], 2],
        ["막대그래프에서 세로 눈금 한 칸의 크기는?", ["항상 1이다", "자료의 크기에 따라 정한다", "항상 10이다", "마음대로 정한다"], 1],
        ["조, 억, 만 단위는 몇 자리씩 끊어 읽는가?", ["3자리", "4자리", "5자리", "2자리"], 1],
        ["각도의 합과 차를 구할 때 주의할 점은?", ["자연수의 덧셈 뺄셈과 같다", "60진법을 쓴다", "뺄셈은 불가능하다", "합은 180도를 넘을 수 없다"], 0],
        ["이등변삼각형은 정삼각형인가?", ["항상 그렇다", "아닐 수도 있다", "절대 아니다", "모른다"], 1],
        ["정삼각형의 한 내각의 크기는?", ["45도", "60도", "90도", "30도"], 1],
        ["세 자리 수 나누기 두 자리 수의 몫은?", ["항상 한 자리 수", "항상 두 자리 수", "한 자리 또는 두 자리 수", "세 자리 수"], 2],
        ["규칙적인 계산식: 1×1=1, 11×11=121, 111×111=?", ["1221", "12321", "11111", "12345"], 1],
        ["막대그래프의 장점은?", ["수량의 많고 적음을 비교하기 쉽다", "전체에 대한 비율을 알기 쉽다", "변화를 알기 쉽다", "정확하지 않다"], 0]
    ],
    "4-2-수학": [
        ["진분수의 덧셈 결과가 가분수이면?", ["그대로 둔다", "대분수로 고친다", "버린다", "0으로 쓴다"], 1],
        ["대분수의 뺄셈 방법은?", ["자연수는 자연수끼리, 분수는 분수끼리", "분모끼리 뺀다", "분자끼리 곱한다", "자연수만 뺀다"], 0],
        ["정삼각형의 성질이 아닌 것은?", ["세 변의 길이가 같다", "세 각의 크기가 60도다", "이등변삼각형이다", "한 각이 직각이다"], 3],
        ["두 변의 길이가 같은 삼각형은?", ["직각삼각형", "둔각삼각형", "이등변삼각형", "부등변삼각형"], 2],
        ["소수 두 자리 수의 덧셈에서 중요한 것은?", ["자릿수(소수점) 맞추기", "뒤에서부터 채우기", "소수점 무시하기", "길이 맞추기"], 0],
        ["0.5 + 0.03 은?", ["0.08", "0.53", "0.35", "0.8"], 1],
        ["마주 보는 두 쌍의 변이 서로 평행한 사각형은?", ["사다리꼴", "평행사변형", "연꼴", "삼각형"], 1],
        ["네 변의 길이가 모두 같은 사각형은?", ["직사각형", "마름모", "사다리꼴", "평행사변형"], 1],
        ["직사각형과 정사각형의 공통점은?", ["네 각이 모두 직각이다", "네 변의 길이가 같다", "대각선이 수직이다", "모두 예각이다"], 0],
        ["꺾은선그래프에서 변화가 심한 구간은?", ["선이 수평인 곳", "선이 가파르게 기울어진 곳", "선이 완만한 곳", "선이 끊긴 곳"], 1],
        ["꺾은선그래프의 물결선의 역할은?", ["모양을 예쁘게 한다", "필요 없는 구간을 줄여 변화를 잘 보여준다", "그래프를 크게 만든다", "종이를 아낀다"], 1],
        ["다각형이란?", ["선분으로만 둘러싸인 도형", "곡선이 있는 도형", "열린 도형", "입체 도형"], 0],
        ["대각선의 개수가 가장 많은 것은?", ["삼각형", "사각형", "오각형", "육각형"], 3],
        ["소수 뺄셈: 1 - 0.3 은?", ["0.7", "1.3", "0.3", "0.07"], 0],
        ["평행선 사이의 거리는?", ["어디서 재도 같다", "다 다르다", "점점 멀어진다", "점점 가까워진다"], 0],
        ["사다리꼴의 정의는?", ["평행한 변이 한 쌍이라도 있는 사각형", "두 쌍이 평행한 사각형", "네 변이 같은 사각형", "각이 같은 사각형"], 0],
        ["삼각형의 세 변의 길이 관계?", ["가장 긴 변은 나머지 두 변의 합보다 작아야 한다", "커야 한다", "같아야 한다", "상관없다"], 0],
        ["육각형의 대각선 총 개수는?", ["5개", "9개", "14개", "20개"], 1],
        ["자료의 값을 점으로 찍고 선분으로 이은 그래프는?", ["막대그래프", "꺾은선그래프", "그림그래프", "원그래프"], 1],
        ["소수점 아래 0을 생략할 수 있는 경우는?", ["소수점 맨 끝자리", "소수점 바로 뒤", "자연수 부분", "중간"], 0]
    ],
    "5-1-수학": [
        ["약수와 배수의 관계는?", ["곱셈과 나눗셈 관계", "덧셈 관계", "뺄셈 관계", "상관없다"], 0],
        ["약수가 1과 자신뿐인 수는?", ["합성수", "소수", "짝수", "홀수"], 1],
        ["12와 18의 최대공약수는?", ["3", "4", "6", "12"], 2],
        ["두 수의 공배수는 무엇의 배수인가?", ["최대공약수", "최소공배수", "두 수의 합", "두 수의 차"], 1],
        ["약분한다는 것은?", ["분모와 분자를 0으로 만드는 것", "분모와 분자를 공약수로 나누는 것", "분모와 분자에 같은 수를 곱하는 것", "역수로 만드는 것"], 1],
        ["기약분수란?", ["더 이상 약분되지 않는 분수", "분모가 10인 분수", "분자가 1인 분수", "가분수"], 0],
        ["통분할 때 공통분모로 알맞은 것은?", ["두 분모의 최소공배수", "두 분모의 합", "두 분모의 차", "두 분모의 최대공약수"], 0],
        ["분모가 다른 분수의 덧셈 순서는?", ["약분 -> 덧셈", "통분 -> 덧셈", "그냥 덧셈", "분자끼리 덧셈"], 1],
        ["다각형의 둘레를 구하는 방법은?", ["가로 곱하기 세로", "모든 변의 길이를 더한다", "대각선을 잰다", "한 변만 잰다"], 1],
        ["직사각형의 넓이 공식은?", ["가로 + 세로", "가로 × 세로", "(가로 + 세로) × 2", "가로 ÷ 세로"], 1],
        ["평행사변형의 넓이는?", ["밑변 × 높이", "밑변 × 높이 ÷ 2", "한 변 × 한 변", "윗변 + 아랫변"], 0],
        ["삼각형의 넓이는?", ["밑변 × 높이", "밑변 × 높이 ÷ 2", "밑변 + 높이", "밑변 × 다른 변"], 1],
        ["마름모의 넓이는?", ["한 대각선 × 다른 대각선", "한 대각선 × 다른 대각선 ÷ 2", "한 변 × 한 변", "밑변 × 높이"], 1],
        ["사다리꼴의 넓이 공식은?", ["(윗변+아랫변) × 높이 ÷ 2", "윗변 × 아랫변 × 높이", "윗변 + 아랫변 + 높이", "밑변 × 높이"], 0],
        ["1제곱미터는 몇 제곱센티미터인가?", ["100", "1000", "10000", "100000"], 2],
        ["대응 관계를 식으로 나타낼 때 사용하는 것은?", ["기호(□, △ 등)나 문자", "그림", "색깔", "소리"], 0],
        ["가장 작은 소수는?", ["1", "2", "3", "0"], 1],
        ["모든 자연수의 약수는?", ["0", "1", "2", "자기 자신"], 1],
        ["최대공약수가 1인 두 수의 관계는?", ["서로소", "배수 관계", "약수 관계", "짝수 관계"], 0],
        ["2/3 와 4/6 는 같은 분수인가?", ["같다", "다르다", "알 수 없다", "반대다"], 0]
    ],
    "5-2-수학": [
        ["어떤 수와 같거나 큰 수는?", ["초과", "미만", "이상", "이하"], 2],
        ["어떤 수보다 작은 수는?", ["초과", "미만", "이상", "이하"], 1],
        ["버림하여 십의 자리까지 나타내기: 125 -> ?", ["130", "120", "100", "125"], 1],
        ["반올림: 5 이상이면?", ["버린다", "올린다", "그대로 둔다", "지운다"], 1],
        ["분수의 곱셈: (진분수) × (자연수) 계산법?", ["분모는 그대로, 분자와 자연수를 곱함", "분모와 자연수를 곱함", "통분하여 계산", "역수를 곱함"], 0],
        ["대분수의 곱셈 방법?", ["가분수로 고쳐서 계산", "대분수 그대로 계산", "자연수는 버리고 계산", "분모끼리만 계산"], 0],
        ["합동인 도형의 성질은?", ["모양이 같고 크기는 다르다", "크기는 같고 모양은 다르다", "모양과 크기가 모두 같다", "넓이만 같다"], 2],
        ["대응변이란?", ["서로 포개지는 변", "마주 보는 변", "이웃하는 변", "가장 긴 변"], 0],
        ["선대칭도형의 대칭축은?", ["하나뿐이다", "없다", "하나 이상일 수 있다", "무수히 많다"], 2],
        ["점대칭도형의 회전 각도는?", ["90도", "180도", "270도", "360도"], 1],
        ["직육면체의 면의 개수는?", ["4개", "6개", "8개", "12개"], 1],
        ["정육면체의 모서리 개수는?", ["8개", "10개", "12개", "6개"], 2],
        ["직육면체의 겨냥도에서 보이지 않는 선은?", ["실선", "점선", "물결선", "직선"], 1],
        ["정육면체의 전개도는 몇 가지인가?", ["1가지", "6가지", "11가지", "무수히 많다"], 2],
        ["평균을 구하는 식은?", ["자료의 합 ÷ 자료의 수", "자료의 합 × 자료의 수", "가장 큰 값 - 가장 작은 값", "자료 중 한가운데 값"], 0],
        ["일이 일어날 가능성이 '반반이다'를 수로 표현하면?", ["0", "1", "1/2", "100"], 2],
        ["확실하게 일어날 가능성은 수로?", ["0", "0.5", "1", "10"], 2],
        ["세 변의 길이가 3, 4, 5인 삼각형과 합동인 삼각형을 그리려면?", ["각도기만 필요하다", "컴퍼스와 자가 필요하다", "눈금 없는 자만 필요하다", "그릴 수 없다"], 1],
        ["점대칭도형의 대칭의 중심은 몇 개인가?", ["1개", "2개", "3개", "없다"], 0],
        ["직육면체의 밑면은 몇 쌍인가?", ["1쌍", "2쌍", "3쌍", "4쌍"], 2]
    ],
    "6-1-수학": [
        ["(자연수) ÷ (자연수)의 몫을 분수로 나타내면?", ["(나누는 수)/(나누어지는 수)", "(나누어지는 수)/(나누는 수)", "항상 자연수", "항상 가분수"], 1],
        ["(분수) ÷ (자연수) 계산법?", ["분자의 곱으로 바꾼다", "나눗셈을 곱셈으로 바꾸고 자연수의 역수를 곱한다", "분모를 나눈다", "그대로 둔다"], 1],
        ["각기둥의 이름은 무엇으로 정하나?", ["옆면의 모양", "높이", "밑면의 모양", "모서리의 수"], 2],
        ["각뿔의 옆면 모양은 항상?", ["사각형", "삼각형", "원", "오각형"], 1],
        ["각기둥의 꼭짓점 수(n각기둥)?", ["n개", "2n개", "3n개", "n+2개"], 1],
        ["소수 나눗셈에서 자릿수가 모자랄 때?", ["그대로 둔다", "0을 내려 계산한다", "계산을 멈춘다", "나머지로 쓴다"], 1],
        ["비 3 : 4 에서 기준량은?", ["3", "4", "7", "1"], 1],
        ["비율을 구하는 식은?", ["비교하는 양 ÷ 기준량", "기준량 ÷ 비교하는 양", "기준량 + 비교하는 양", "비교하는 양 × 기준량"], 0],
        ["백분율이란?", ["기준량을 10으로 할 때의 비율", "기준량을 100으로 할 때의 비율", "기준량을 1000으로 할 때의 비율", "전체 양"], 1],
        ["비율 0.75를 백분율로 나타내면?", ["7.5%", "75%", "0.75%", "750%"], 1],
        ["전체에 대한 각 부분의 비율을 원 모양에 나타낸 그래프?", ["막대그래프", "꺾은선그래프", "띠그래프", "원그래프"], 3],
        ["띠그래프의 특징은?", ["변화를 알기 쉽다", "전체에 대한 각 부분의 비율을 한눈에 알 수 있다", "수량이 정확하다", "그리기 어렵다"], 1],
        ["직육면체의 부피 구하는 공식?", ["가로 + 세로 + 높이", "가로 × 세로 × 높이", "밑면의 넓이 + 높이", "한 모서리 × 3"], 1],
        ["1세제곱미터는 몇 세제곱센티미터?", ["10000", "100000", "1000000", "100"], 2],
        ["직육면체의 겉넓이 구하는 방법?", ["여섯 면의 넓이의 합", "세 면의 넓이 × 2", "밑면의 넓이 × 높이", "부피 × 2"], 0],
        ["원주율이란?", ["원주 ÷ 지름", "지름 ÷ 원주", "반지름 × 3", "원의 넓이"], 0],
        ["원주율은 약 얼마인가?", ["3.14", "3", "3.141592...", "모두 맞음"], 3],
        ["원의 넓이 구하는 공식?", ["지름 × 원주율", "반지름 × 반지름 × 원주율", "원주 × 2", "반지름 × 2 × 원주율"], 1],
        ["각뿔의 모서리 수(n각뿔)?", ["n개", "2n개", "3n개", "n+1개"], 1],
        ["비율이 같은 두 비를 등호로 연결한 식은?", ["비례식", "방정식", "부등식", "다항식"], 0]
    ],
    "6-2-수학": [
        ["분수의 나눗셈: (분수)÷(분수) 계산법?", ["통분하여 분자끼리 나누거나, 곱셈으로 고쳐서 계산", "분모끼리 나눈다", "분자끼리 더한다", "뺄셈으로 계산"], 0],
        ["소수의 나눗셈에서 몫의 소수점 위치는?", ["나누어지는 수의 옮긴 소수점 위치와 같다", "항상 맨 뒤다", "항상 맨 앞이다", "나누는 수와 같다"], 0],
        ["공간에서 쌓기나무의 개수를 정확히 알 수 있는 방법?", ["위에서 본 모양에 수 쓰기", "앞에서만 보기", "옆에서만 보기", "사진 찍기"], 0],
        ["비례식의 성질?", ["전항과 후항의 합이 같다", "외항의 곱과 내항의 곱이 같다", "전항과 내항의 곱이 같다", "후항과 외항의 합이 같다"], 1],
        ["비례배분이란?", ["전체를 똑같이 나누는 것", "전체를 주어진 비로 배분하는 것", "남는 것을 가지는 것", "랜덤으로 나누는 것"], 1],
        ["원의 넓이: 반지름이 2배가 되면 넓이는?", ["2배", "3배", "4배", "변함없다"], 2],
        ["원기둥의 밑면의 모양은?", ["사각형", "삼각형", "원", "부채꼴"], 2],
        ["원기둥의 전개도에서 옆면의 가로 길이는?", ["원기둥의 높이", "밑면의 지름", "밑면의 원주", "밑면의 반지름"], 2],
        ["원뿔의 뾰족한 점을 무엇이라 하는가?", ["꼭짓점", "원뿔의 꼭짓점", "모선", "중심"], 1],
        ["구의 특징은?", ["어느 방향에서 보아도 원 모양이다", "밑면이 1개다", "전개도를 그릴 수 있다", "뾰족하다"], 0],
        ["원기둥의 부피 구하는 식?", ["한 밑면의 넓이 × 높이", "반지름 × 원주율", "겉넓이 × 높이", "밑면의 둘레 × 높이"], 0],
        ["원기둥의 겉넓이는?", ["한 밑면의 넓이 × 2 + 옆면의 넓이", "밑면 × 높이", "옆면 × 2", "부피 × 2"], 0],
        ["가능성이 0인 경우는?", ["절대 일어나지 않는다", "반반이다", "확실하다", "아마도 일어난다"], 0],
        ["3 : 4 = 6 : □, 네모 안의 수는?", ["7", "8", "9", "12"], 1],
        ["쌓기나무 층별로 나타낸 모양의 장점?", ["보이지 않는 부분까지 확실히 알 수 있다", "그리기 쉽다", "전체 모양을 알기 어렵다", "색깔을 알 수 있다"], 0],
        ["원주를 구하는 식?", ["지름 × 원주율", "반지름 × 원주율", "지름 + 원주율", "반지름 × 반지름"], 0],
        ["3.6 ÷ 0.6 의 몫은?", ["6", "0.6", "60", "0.06"], 0],
        ["비 5:8의 전항과 후항에 2를 곱하면 비율은?", ["커진다", "작아진다", "변하지 않는다", "알 수 없다"], 2],
        ["가장 간단한 자연수의 비로 나타내기: 0.5 : 1.5", ["1:3", "1:2", "1:5", "5:15"], 0],
        ["원뿔에서 모선의 길이는?", ["모두 같다", "높이와 같다", "다르다", "밑면 지름과 같다"], 0]
    ],

    // ================= [영어] (각 20문제) =================
    "3-1-영어": [
        ["'사과'를 영어로?", ["Apple", "Banana", "Grape", "Melon"], 0],
        ["'안녕하세요' 인사말?", ["Hello", "Bye", "Sorry", "No"], 0],
        ["'개'를 영어로?", ["Dog", "Cat", "Bird", "Pig"], 0],
        ["알파벳 A의 다음 글자는?", ["B", "C", "D", "E"], 0],
        ["'하나(1)'를 영어로?", ["One", "Two", "Three", "Four"], 0],
        ["'빨간색'을 영어로?", ["Red", "Blue", "Green", "Yellow"], 0],
        ["'내 이름은...' 영어로?", ["My name is...", "I am fine", "Thank you", "Good bye"], 0],
        ["'고맙습니다' 영어로?", ["Thank you", "Sorry", "Hello", "Hi"], 0],
        ["'연필'을 영어로?", ["Pencil", "Book", "Bag", "Desk"], 0],
        ["'엄마'를 영어로?", ["Mom", "Dad", "Brother", "Sister"], 0],
        ["알파벳 Z의 앞 글자는?", ["Y", "X", "W", "V"], 0],
        ["'책'을 영어로?", ["Book", "Pen", "Eraser", "Ruler"], 0],
        ["'일어서세요' 영어로?", ["Stand up", "Sit down", "Open your book", "Close your book"], 0],
        ["'앉으세요' 영어로?", ["Sit down", "Stand up", "Jump", "Run"], 0],
        ["'이것은 무엇입니까?'", ["What is this?", "Who are you?", "How are you?", "What time is it?"], 0],
        ["'물고기'를 영어로?", ["Fish", "Dog", "Cat", "Bird"], 0],
        ["'파란색'을 영어로?", ["Blue", "Red", "Black", "White"], 0],
        ["숫자 '5'를 영어로?", ["Five", "Four", "Six", "Seven"], 0],
        ["'안녕히 가세요' 영어로?", ["Good bye", "Hello", "Good morning", "Nice to meet you"], 0],
        ["'좋아' 영어로?", ["Good", "Bad", "Sad", "Angry"], 0]
    ],
    "3-2-영어": [
        ["'나는 ...를 좋아해' 영어로?", ["I like...", "I hate...", "I have...", "I am..."], 0],
        ["'피자'를 영어로?", ["Pizza", "Burger", "Chicken", "Salad"], 0],
        ["'고양이'를 영어로?", ["Cat", "Dog", "Mouse", "Cow"], 0],
        ["'행복한' 영어로?", ["Happy", "Sad", "Angry", "Tired"], 0],
        ["'몇 살이니?' 영어로?", ["How old are you?", "How are you?", "What is your name?", "Where are you?"], 0],
        ["'나는 10살이야' 영어로?", ["I am ten", "I am one", "I am five", "I am happy"], 0],
        ["'색깔'을 영어로?", ["Color", "Shape", "Size", "Number"], 0],
        ["'검은색'을 영어로?", ["Black", "White", "Red", "Blue"], 0],
        ["'크다'를 영어로?", ["Big", "Small", "Short", "Long"], 0],
        ["'작다'를 영어로?", ["Small", "Big", "Tall", "Fast"], 0],
        ["'우유'를 영어로?", ["Milk", "Water", "Juice", "Tea"], 0],
        ["'치즈'를 영어로?", ["Cheese", "Bread", "Rice", "Meat"], 0],
        ["'미안합니다' 영어로?", ["I'm sorry", "Thank you", "You're welcome", "Hello"], 0],
        ["'괜찮아요' 영어로?", ["It's okay", "No", "Yes", "Bad"], 0],
        ["'눈(신체)'을 영어로?", ["Eye", "Ear", "Nose", "Mouth"], 0],
        ["'코'를 영어로?", ["Nose", "Eye", "Hand", "Foot"], 0],
        ["'만지다'를 영어로?", ["Touch", "Look", "Listen", "Smell"], 0],
        ["'이것은 사과야'", ["It is an apple", "It is a banana", "It is a cat", "It is a dog"], 0],
        ["'저것은 공이야'", ["That is a ball", "This is a ball", "It is a doll", "Here is a ball"], 0],
        ["'가방'을 영어로?", ["Bag", "Box", "Cap", "Hat"], 0]
    ],
    "4-1-영어": [
        ["'지금 몇 시니?' 영어로?", ["What time is it?", "What day is it?", "Where are you?", "How old are you?"], 0],
        ["'학교'를 영어로?", ["School", "Home", "Park", "Store"], 0],
        ["'공원'을 영어로?", ["Park", "Zoo", "Farm", "Hospital"], 0],
        ["'가자' 영어로?", ["Let's go", "Let's play", "Let's eat", "Let's sleep"], 0],
        ["'축구하다' 영어로?", ["Play soccer", "Play baseball", "Play basketball", "Play tennis"], 0],
        ["'배고픈' 영어로?", ["Hungry", "Full", "Thirsty", "Sleepy"], 0],
        ["'물 좀 줄래?'", ["Water, please?", "No water", "I like water", "Water is good"], 0],
        ["'여기 있어'", ["Here you are", "Thank you", "Goodbye", "See you"], 0],
        ["'월요일' 영어로?", ["Monday", "Tuesday", "Sunday", "Friday"], 0],
        ["'일요일' 영어로?", ["Sunday", "Saturday", "Monday", "Wednesday"], 0],
        ["'오늘 무슨 요일이니?'", ["What day is it today?", "What time is it?", "How is the weather?", "Who are you?"], 0],
        ["'비가 와요' 영어로?", ["It's raining", "It's sunny", "It's snowing", "It's windy"], 0],
        ["'맑아요' 영어로?", ["It's sunny", "It's cloudy", "It's rainy", "It's cold"], 0],
        ["'어디에 있니?'", ["Where is it?", "What is it?", "Who is it?", "When is it?"], 0],
        ["'침대 위에' 영어로?", ["On the bed", "In the bed", "Under the bed", "By the bed"], 0],
        ["'상자 안에' 영어로?", ["In the box", "On the box", "Under the box", "Next to the box"], 0],
        ["'식탁 아래에' 영어로?", ["Under the table", "On the table", "In the table", "By the table"], 0],
        ["'엄마는 어디 계시니?'", ["Where is Mom?", "Who is Mom?", "How is Mom?", "What is Mom?"], 0],
        ["'부엌에 계셔'", ["She is in the kitchen", "She is in the bedroom", "She is in the bathroom", "She is in the living room"], 0],
        ["'거실'을 영어로?", ["Living room", "Kitchen", "Bedroom", "Bathroom"], 0]
    ],
    "4-2-영어": [
        ["'얼마인가요?' 영어로?", ["How much is it?", "How many?", "How old?", "How are you?"], 0],
        ["'500원이야'", ["It's 500 won", "It's 5 won", "It's 50 won", "It's 5000 won"], 0],
        ["'비싸다' 영어로?", ["Expensive", "Cheap", "Good", "Bad"], 0],
        ["'싸다' 영어로?", ["Cheap", "Expensive", "Big", "Small"], 0],
        ["'나는 ...을 할 수 있어'", ["I can...", "I do...", "I am...", "I have..."], 0],
        ["'수영하다' 영어로?", ["Swim", "Run", "Jump", "Fly"], 0],
        ["'노래하다' 영어로?", ["Sing", "Dance", "Read", "Write"], 0],
        ["'도와줄까?'", ["Can I help you?", "Do you help?", "I help you", "Help me"], 0],
        ["'물론이지' 영어로?", ["Sure", "No", "Sorry", "Bad"], 0],
        ["'직업'을 영어로?", ["Job", "Name", "Age", "Color"], 0],
        ["'선생님' 영어로?", ["Teacher", "Student", "Doctor", "Cook"], 0],
        ["'의사' 영어로?", ["Doctor", "Nurse", "Pilot", "Singer"], 0],
        ["'요리사' 영어로?", ["Cook", "Teacher", "Farmer", "Police officer"], 0],
        ["'이것은 누구의 것이니?'", ["Whose is this?", "What is this?", "Where is this?", "Who are you?"], 0],
        ["'내 거야'", ["It's mine", "It's yours", "It's his", "It's hers"], 0],
        ["'너의 것' 영어로?", ["Yours", "Mine", "His", "Hers"], 0],
        ["'일어나다' 영어로?", ["Get up", "Go to bed", "Wash face", "Eat breakfast"], 0],
        ["'학교에 가다' 영어로?", ["Go to school", "Go home", "Go to bed", "Go to park"], 0],
        ["'몇 시에 일어나니?'", ["What time do you get up?", "What time do you sleep?", "What time is it?", "Where do you go?"], 0],
        ["'7시에' 영어로?", ["At 7", "In 7", "On 7", "For 7"], 0]
    ],
    "5-1-영어": [
        ["'출신 국가'를 물을 때?", ["Where are you from?", "Who are you?", "How are you?", "What is your name?"], 0],
        ["'나는 한국에서 왔어'", ["I'm from Korea", "I'm Korea", "I live Korea", "My name is Korea"], 0],
        ["'미국'을 영어로?", ["America (USA)", "Canada", "UK", "Australia"], 0],
        ["'무엇을 하고 있니?' (현재진행)", ["What are you doing?", "What do you do?", "What did you do?", "What will you do?"], 0],
        ["'나는 요리하고 있어'", ["I'm cooking", "I cook", "I cooked", "I will cook"], 0],
        ["'나는 책을 읽고 있어'", ["I'm reading a book", "I read a book", "I write a book", "I buy a book"], 0],
        ["'길을 묻을 때'", ["Where is the...?", "What is the...?", "Who is the...?", "When is the...?"], 0],
        ["'오른쪽으로 도세요'", ["Turn right", "Turn left", "Go straight", "Stop"], 0],
        ["'쭉 가세요'", ["Go straight", "Turn back", "Turn left", "Turn right"], 0],
        ["'박물관' 영어로?", ["Museum", "Library", "Bank", "Post office"], 0],
        ["'우체국' 영어로?", ["Post office", "Police station", "Fire station", "School"], 0],
        ["'주말에 뭐 했니?'", ["What did you do on the weekend?", "What do you do?", "What are you doing?", "What will you do?"], 0],
        ["'나는 영화를 봤어'", ["I saw a movie", "I see a movie", "I seeing a movie", "I will see a movie"], 0],
        ["'좋은 시간 보냈어'", ["I had a good time", "I have a good time", "It is good", "See you"], 0],
        ["'먹다'의 과거형?", ["Ate", "Eat", "Eating", "Eats"], 0],
        ["'가다'의 과거형?", ["Went", "Go", "Going", "Goes"], 0],
        ["'좋아하는 과목' 묻기?", ["What's your favorite subject?", "Do you like school?", "What is this?", "Who is your teacher?"], 0],
        ["'수학'을 영어로?", ["Math", "English", "Science", "Music"], 0],
        ["'과학'을 영어로?", ["Science", "Math", "Art", "PE"], 0],
        ["'미술'을 영어로?", ["Art", "Music", "English", "History"], 0]
    ],
    "5-2-영어": [
        ["'미래 희망' 묻기?", ["What do you want to be?", "What are you?", "Who are you?", "Where are you?"], 0],
        ["'나는 비행기 조종사가 되고 싶어'", ["I want to be a pilot", "I am a pilot", "I like pilot", "Pilot is good"], 0],
        ["'왜?' 라고 물을 때?", ["Why?", "What?", "Where?", "When?"], 0],
        ["'왜냐하면...' 영어로?", ["Because...", "So...", "But...", "And..."], 0],
        ["'너는 ...해야 해' (의무)", ["You should...", "You can...", "You may...", "You will..."], 0],
        ["'일찍 자야 해'", ["You should go to bed early", "You go to bed", "Sleep now", "Don't sleep"], 0],
        ["'양치질하다' 영어로?", ["Brush your teeth", "Wash your face", "Wash your hands", "Comb your hair"], 0],
        ["'어제' 영어로?", ["Yesterday", "Today", "Tomorrow", "Now"], 0],
        ["'내일' 영어로?", ["Tomorrow", "Yesterday", "Tonight", "Last week"], 0],
        ["'비교급' 더 키가 큰?", ["Taller", "Tall", "Tallest", "More tall"], 0],
        ["'더 빠른' 영어로?", ["Faster", "Fast", "Fastest", "Slow"], 0],
        ["'가장 힘센' (최상급)?", ["Strongest", "Stronger", "Strong", "More strong"], 0],
        ["'누가 더 키가 크니?'", ["Who is taller?", "Who is tall?", "Who is tallest?", "Who are you?"], 0],
        ["'제안하기'", ["Let's...", "Do you...", "Are you...", "Can you..."], 0],
        ["'우리 축구하자'", ["Let's play soccer", "I play soccer", "You play soccer", "Play soccer"], 0],
        ["'전화 걸 때'", ["This is...", "I am...", "My name is...", "Here is..."], 0],
        ["'지수 있나요?' (전화)", ["Is Jisu there?", "Where is Jisu?", "Who is Jisu?", "I want Jisu"], 0],
        ["'기다려 주세요'", ["Hold on, please", "Stop", "Go", "Bye"], 0],
        ["'생일이 언제니?'", ["When is your birthday?", "What is your birthday?", "Where is your birthday?", "How is your birthday?"], 0],
        ["'10월 9일이야'", ["It's October 9th", "It's October 9", "October 9", "9th October"], 0]
    ],
    "6-1-영어": [
        ["'몇 학년이니?'", ["What grade are you in?", "How old are you?", "What class is it?", "Where is your school?"], 0],
        ["'나는 6학년이야'", ["I'm in the 6th grade", "I'm 6 years old", "I have 6 grades", "Grade 6"], 0],
        ["'아픈 곳' 묻기?", ["What's wrong?", "How are you?", "What do you do?", "Where do you go?"], 0],
        ["'배가 아파요'", ["I have a stomachache", "I have a headache", "I have a cold", "I am hungry"], 0],
        ["'두통' 영어로?", ["Headache", "Toothache", "Stomachache", "Cold"], 0],
        ["'약 좀 먹으렴'", ["Take some medicine", "Eat food", "Drink water", "Sleep well"], 0],
        ["'생일 축하해'", ["Happy birthday", "Good luck", "Congratulations", "Thank you"], 0],
        ["'날짜' 묻기?", ["What's the date today?", "What day is it?", "What time is it?", "When is it?"], 0],
        ["'3월 1일이야'", ["It's March 1st", "It's March 1", "March one", "1st March"], 0],
        ["'과거의 할 수 있었던 일'?", ["I could...", "I can...", "I will...", "I should..."], 0],
        ["'나는 수영할 수 있었어'", ["I could swim", "I can swim", "I swim", "I swam"], 0],
        ["'하지만 지금은 못해'", ["But now I can't", "And I can", "So I can't", "Or I can't"], 0],
        ["'장래희망' 말하기?", ["I want to be a...", "I am a...", "I like...", "I have..."], 0],
        ["'과학자' 영어로?", ["Scientist", "Artist", "Pianist", "Dentist"], 0],
        ["'화가' 영어로?", ["Painter / Artist", "Singer", "Writer", "Driver"], 0],
        ["'자주 하는 일' 빈도 묻기?", ["How often do you...?", "How do you...?", "What do you...?", "Where do you...?"], 0],
        ["'일주일에 한번'", ["Once a week", "One a week", "First a week", "Once week"], 0],
        ["'매일' 영어로?", ["Every day", "Today", "Yesterday", "Tomorrow"], 0],
        ["'아침 식사' 영어로?", ["Breakfast", "Lunch", "Dinner", "Snack"], 0],
        ["'저녁 식사' 영어로?", ["Dinner", "Lunch", "Breakfast", "Supper"], 0]
    ],
    "6-2-영어": [
        ["'외모 묘사' 묻기?", ["What does he look like?", "Who is he?", "How is he?", "Where is he?"], 0],
        ["'그는 키가 크고 눈이 파래'", ["He is tall and has blue eyes", "He is short", "He has blue eyes", "He is big"], 0],
        ["'긴 머리' 영어로?", ["Long hair", "Short hair", "Curly hair", "Straight hair"], 0],
        ["'곱슬머리' 영어로?", ["Curly hair", "Straight hair", "Long hair", "Blond hair"], 0],
        ["'입고 있다' (현재 진행)", ["Wearing", "Wear", "Wears", "Wore"], 0],
        ["'그녀는 빨간 모자를 쓰고 있어'", ["She is wearing a red cap", "She wears a red cap", "She has a red cap", "Red cap"], 0],
        ["'허락 구하기'", ["May I...?", "Can you...?", "Do you...?", "Are you...?"], 0],
        ["'화장실 가도 되나요?'", ["May I go to the restroom?", "Where is the restroom?", "I go to restroom", "Restroom please"], 0],
        ["'물론이지'", ["Of course / Sure", "No", "Sorry", "Bad"], 0],
        ["'이해했니?' 확인", ["Do you understand?", "What is it?", "Who knows?", "Can you?"], 0],
        ["'미래 계획' (will)", ["I will...", "I do...", "I did...", "I am..."], 0],
        ["'나는 캠핑 갈 거야'", ["I will go camping", "I go camping", "I went camping", "I going camping"], 0],
        ["'이번 여름에'", ["This summer", "Last summer", "Next summer", "Summer"], 0],
        ["'비교하기' (최상급)", ["The strongest", "Stronger", "Strong", "More strong"], 0],
        ["'가장 빠른 동물은 뭐야?'", ["What is the fastest animal?", "Who is fast?", "Where is animal?", "How fast?"], 0],
        ["'치타가 가장 빨라'", ["The cheetah is the fastest", "Cheetah is fast", "Cheetah is faster", "Fast cheetah"], 0],
        ["'길 안내'", ["Go straight and turn left", "Go back", "Stop here", "Run"], 0],
        ["'박물관은 병원 옆에 있어'", ["The museum is next to the hospital", "The museum is in the hospital", "The museum is on the hospital", "Museum hospital"], 0],
        ["'건너편에' 영어로?", ["Across from", "Next to", "Behind", "In front of"], 0],
        ["'즐거운 주말 보내'", ["Have a nice weekend", "Good weekend", "Nice weekend", "Weekend"], 0]
    ]
};

const subjects = ["국어", "수학", "사회", "과학", "영어"];

function generateProblemBank(grade, semester) {
    const bank = { "국어": [], "수학": [], "사회": [], "과학": [], "영어": [] };
    
    // 과목별로 staticDB에서 데이터를 가져와서 섞어 넣음
    subjects.forEach(sub => {
        let key = "";
        // 모든 과목에 대해 학년-학기-과목 키 사용
        key = `${grade}-${semester}-${sub}`;

        // 해당 키가 없으면 기본적으로 3-1 데이터 등을 사용하거나 빈 배열 방지 (오류 방지용)
        let src = staticDB[key];
        
        // 만약 해당 학년/학기 데이터가 없으면 (예: 데이터 누락 등) 가장 첫 데이터(3-1)라도 가져오도록 안전장치
        if (!src && staticDB[`3-1-${sub}`]) src = staticDB[`3-1-${sub}`];

        if (src) {
            // 문제 순서 섞기 (매 게임마다 다르게)
            const shuffledSrc = [...src].sort(() => Math.random() - 0.5);
            
            // 최대 20문제 가져오기
            const count = Math.min(shuffledSrc.length, 20);
            
            for(let i=0; i<count; i++) {
                const qData = shuffledSrc[i];
                const qText = qData[0];
                const correctText = qData[1][qData[2]]; // 원본 데이터에서 정답 텍스트 추출
                let options = [...qData[1]]; // 보기 복사
                
                // 보기 순서 섞기 (정답 위치 랜덤화)
                options.sort(() => Math.random() - 0.5);
                
                // 섞인 보기에서 정답 인덱스 다시 찾기
                const newAnsIndex = options.indexOf(correctText);

                bank[sub].push({
                    q: qText,
                    o: options,
                    a: newAnsIndex
                });
            }
        }
    });

    return bank;
}
        
        // --------------------------------------------------------------------------------------
        // [여기까지] question_bank_generator.js 내용으로 덮어쓰기 끝
        // 아래부터는 게임 핵심 로직이므로 건드리지 않아도 됩니다.
        // --------------------------------------------------------------------------------------

        // --- 오디오 시스템 ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let bgmInterval;
        
        function playTone(freq, type, duration, vol = 0.1) {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.setValueAtTime(vol, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        function playBGM() {
            if(bgmInterval) clearInterval(bgmInterval);
            
            if (isHardMode) {
                bgmInterval = setInterval(() => {
                    if(gameState !== 'PLAYING') return;
                    const notes = [100, 110, 120, 200, 210, 220]; 
                    playTone(notes[Math.floor(Math.random() * notes.length)], 'sawtooth', 0.5, 0.2);
                    if(Math.random() < 0.3) playTone(Math.random()*800, 'square', 0.1, 0.05); 
                }, 300);
            } else {
                bgmInterval = setInterval(() => {
                    if(gameState !== 'PLAYING') return;
                    const notes = [523, 587, 659, 698, 783, 880, 987];
                    playTone(notes[Math.floor(Math.random() * notes.length)], 'sine', 1.5, 0.1);
                    if(Math.random() < 0.1) playTone(notes[0]-100, 'sawtooth', 2.0, 0.05);
                }, 800);
            }
        }

        function playScream() {
            playTone(800, 'sawtooth', 0.5, 0.5);
            setTimeout(() => playTone(700, 'sawtooth', 0.5, 0.5), 100);
            setTimeout(() => playTone(600, 'sawtooth', 1.0, 0.5), 200);
        }

        function playSpikeSound() {
            playTone(400, 'square', 0.1, 0.3);
            playTone(300, 'square', 0.1, 0.3);
        }

        // --- 전역 변수 ---
        let scene, camera, renderer, world;
        let controls;
        let playerBody, enemyBody;
        let gameState = 'START';
        let hintsCollected = 0;
        const TARGET_HINTS = 10; 
        let timer = 300; 
        let quizBoxes = [];
        let doorMesh = null;
        let currentRoomQuizDeck = [];
        let activeQuizBox = null;
        let isHardMode = false;
        
        let selectedGrade = 6;
        let selectedSemester = 2;
        let generatedBank = {};
        
        let roomOrder = [];
        let currentSubjectIndex = 0;

        let playerSpeed = 25.0; 
        let enemySpeed = 12.0; 

        let enemyMesh;
        let spikes = []; 

        const raycaster = new THREE.Raycaster();
        const center = new THREE.Vector2(0, 0);

        // --- 초기화 ---
        const startBtn = document.getElementById('btn-init');
        startBtn.addEventListener('click', () => {
            selectedGrade = parseInt(document.getElementById('grade-select').value);
            selectedSemester = parseInt(document.getElementById('semester-select').value);
            
            generatedBank = generateProblemBank(selectedGrade, selectedSemester);

            document.getElementById('start-screen').style.display = 'none';
            initGame();
        });

        window.restartGame = (hardMode) => {
            document.getElementById('gameover-screen').style.display = 'none';
            isHardMode = hardMode;
            
            if(isHardMode) {
                enemySpeed = 18.0; 
                timer = 200; 
            } else {
                enemySpeed = 12.0;
                timer = 300;
            }

            while(scene.children.length > 0){ scene.remove(scene.children[0]); }
            world.bodies = [];
            initGame();
        };

        function shuffle(array) { return array.sort(() => Math.random() - 0.5); }

        function initGame() {
            roomOrder = shuffle([...subjects]);
            currentSubjectIndex = 0;
            hintsCollected = 0;
            document.getElementById('hint-count').innerText = `0`;
            
            initThree();
            initPhysics();
            loadRoom(roomOrder[currentSubjectIndex]);
            
            gameState = 'PLAYING';
            playBGM();
            animate();
            
            if(window.gameTimer) clearInterval(window.gameTimer);
            window.gameTimer = setInterval(() => {
                if(gameState === 'PLAYING') {
                    timer--;
                    const m = Math.floor(timer / 60).toString().padStart(2, '0');
                    const s = (timer % 60).toString().padStart(2, '0');
                    document.getElementById('timer-box').innerText = `${m}:${s}`;
                    if(timer <= 0) gameOver("시간이 초과되었습니다...");
                }
            }, 1000);
        }

        function initThree() {
            scene = new THREE.Scene();
            
            if (isHardMode) {
                scene.background = new THREE.Color(0x000000); 
                scene.fog = new THREE.FogExp2(0x220000, 0.05); 
            } else {
                scene.background = new THREE.Color(0x100505); 
                scene.fog = new THREE.FogExp2(0x100505, 0.025); 
            }

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 100);
            
            renderer = new THREE.WebGLRenderer({ antialias: false });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            if (document.querySelector('canvas')) document.body.removeChild(document.querySelector('canvas'));
            document.body.appendChild(renderer.domElement);

            const flashlight = new THREE.SpotLight(0xffffff, isHardMode ? 2.5 : 4); 
            flashlight.angle = Math.PI / 2.5; 
            flashlight.penumbra = 0.5;
            flashlight.decay = 1; 
            flashlight.distance = isHardMode ? 30 : 80; 
            flashlight.castShadow = true;
            camera.add(flashlight);
            flashlight.target = camera; 
            scene.add(camera);

            const ambient = new THREE.AmbientLight(0xffaa88, isHardMode ? 0.3 : 0.8);
            scene.add(ambient);
        }

        function initPhysics() {
            world = new CANNON.World();
            world.gravity.set(0, -30, 0); 
            
            const defMat = new CANNON.Material();
            const contact = new CANNON.ContactMaterial(defMat, defMat, { friction: 0.0, restitution: 0.0 });
            world.addContactMaterial(contact);

            const shape = new CANNON.Sphere(1.5); 
            playerBody = new CANNON.Body({ mass: 70, shape: shape, material: defMat, fixedRotation: true, linearDamping: 0.9 });
            playerBody.position.set(0, 5, 0);
            world.addBody(playerBody);

            playerBody.addEventListener('collide', (e) => {
                const normal = new CANNON.Vec3();
                e.contact.ni.negate(normal);
                if(normal.dot(new CANNON.Vec3(0,1,0)) > 0.5) canJump = true;
            });

            const eShape = new CANNON.Cylinder(1, 1, 3, 8);
            enemyBody = new CANNON.Body({ mass: 100, shape: eShape, material: defMat, fixedRotation: true, linearDamping: 0.9 });
            enemyBody.position.set(0, -100, 0); 
            world.addBody(enemyBody);

            const eGeo = new THREE.CapsuleGeometry(1, 3, 4, 8);
            const eMat = new THREE.MeshStandardMaterial({ color: 0x000000, roughness: 0.1 }); 
            enemyMesh = new THREE.Mesh(eGeo, eMat);
            
            const eyeGeo = new THREE.SphereGeometry(0.3);
            const eyeMat = new THREE.MeshBasicMaterial({ color: 0xff0000 });
            const eye1 = new THREE.Mesh(eyeGeo, eyeMat);
            eye1.position.set(-0.4, 1, 0.8);
            const eye2 = new THREE.Mesh(eyeGeo, eyeMat);
            eye2.position.set(0.4, 1, 0.8);
            enemyMesh.add(eye1);
            enemyMesh.add(eye2);
            
            scene.add(enemyMesh);

            controls = new PointerLockControls(camera, document.body);
            
            document.body.addEventListener('click', () => {
                const modal = document.getElementById('quiz-modal');
                const goScreen = document.getElementById('gameover-screen');
                const startScreen = document.getElementById('start-screen');
                
                if(gameState === 'PLAYING' && modal.style.display !== 'block' && goScreen.style.display !== 'flex' && startScreen.style.display !== 'flex') {
                    controls.lock();
                    checkInteraction(true);
                }
            });
        }

        function loadRoom(subjectName) {
            document.getElementById('room-name').innerText = `${selectedGrade}-${selectedSemester} ${subjectName}` + (isHardMode ? " (지옥)" : "");
            document.getElementById('hint-count').innerText = `0`;
            hintsCollected = 0;
            
            currentRoomQuizDeck = shuffle([...generatedBank[subjectName]]);
            quizBoxes = [];
            spikes = []; 

            playerBody.position.set(0, 5, 0);
            playerBody.velocity.set(0,0,0);
            
            enemyBody.position.set(40, 5, 40);
            enemyBody.velocity.set(0,0,0);

            createEnvironment();
        }

        function createEnvironment() {
            woodTexture.repeat.set(20, 20);
            const floorGeo = new THREE.PlaneGeometry(100, 100);
            const floorMat = new THREE.MeshStandardMaterial({ map: woodTexture });
            const floor = new THREE.Mesh(floorGeo, floorMat);
            floor.rotation.x = -Math.PI / 2;
            scene.add(floor);
            
            ceilingTexture.repeat.set(10, 10);
            const ceilGeo = new THREE.PlaneGeometry(100, 100);
            const ceilMat = new THREE.MeshStandardMaterial({ map: ceilingTexture, color: 0x888888 });
            const ceil = new THREE.Mesh(ceilGeo, ceilMat);
            ceil.rotation.x = Math.PI / 2;
            ceil.position.y = 15; 
            scene.add(ceil);

            const floorBody = new CANNON.Body({ mass: 0, shape: new CANNON.Plane() });
            floorBody.quaternion.setFromEuler(-Math.PI/2, 0, 0);
            world.addBody(floorBody);

            for(let i=0; i<40; i++) { 
                const x = (Math.random()-0.5) * 80;
                const z = (Math.random()-0.5) * 80;
                if(Math.abs(x) < 5 && Math.abs(z) < 5) continue;
                createBox(x, 7.5, z, 3, 15, 3, 0x5d4037, true, true); 
            }

            for(let i=0; i<15; i++) {
                const x = (Math.random()-0.5) * 70; 
                const z = (Math.random()-0.5) * 70;
                if(Math.abs(x) < 10 && Math.abs(z) < 10) continue;
                
                const mesh = createBox(x, 2, z, 1.5, 1.5, 1.5, 0xffd700, false, false);
                mesh.material.emissive = new THREE.Color(0x333300);
                mesh.userData = { type: 'quiz', id: i };
                quizBoxes.push(mesh);
            }

            const doorGeo = new THREE.BoxGeometry(8, 10, 1);
            const doorMat = new THREE.MeshStandardMaterial({ color: 0x3e2723 });
            doorMesh = new THREE.Mesh(doorGeo, doorMat);
            doorMesh.position.set(0, 5, -45);
            doorMesh.userData = { type: 'door' };
            scene.add(doorMesh);
            
            const doorBody = new CANNON.Body({ mass: 0, shape: new CANNON.Box(new CANNON.Vec3(4, 5, 0.5)) });
            doorBody.position.set(0, 5, -45);
            world.addBody(doorBody);
        }

        function createBox(x, y, z, w, h, d, color, isStatic, useTexture) {
            const geo = new THREE.BoxGeometry(w, h, d);
            const mat = new THREE.MeshStandardMaterial({ 
                color: color, 
                map: useTexture ? woodTexture : null 
            });
            const mesh = new THREE.Mesh(geo, mat);
            mesh.position.set(x, y, z);
            mesh.castShadow = true;
            mesh.receiveShadow = true;
            scene.add(mesh);

            const body = new CANNON.Body({
                mass: isStatic ? 0 : 1,
                shape: new CANNON.Box(new CANNON.Vec3(w/2, h/2, d/2)),
                position: new CANNON.Vec3(x, y, z)
            });
            world.addBody(body);
            return mesh;
        }

        const keyState = {};
        let canJump = false;
        document.addEventListener('keydown', (e) => keyState[e.code] = true);
        document.addEventListener('keyup', (e) => keyState[e.code] = false);

        function checkInteraction(isClick) {
            if (!camera) return;
            raycaster.setFromCamera(center, camera);
            const intersects = raycaster.intersectObjects(scene.children);
            
            const msg = document.getElementById('interact-msg');
            let found = false;

            for(let hit of intersects) {
                if(hit.distance > 8) continue; 

                if(hit.object.userData.type === 'quiz') {
                    found = true;
                    msg.innerText = "[클릭] 힌트 얻기";
                    msg.style.display = 'block';
                    if(isClick) openQuiz(hit.object);
                    break;
                } else if (hit.object.userData.type === 'door') {
                    found = true;
                    if(hintsCollected >= TARGET_HINTS) {
                        msg.innerText = "[클릭] 다음 방으로 탈출";
                        msg.style.color = "#00ff00";
                    } else {
                        msg.innerText = `잠겨있음 (${hintsCollected}/${TARGET_HINTS})`;
                        msg.style.color = "#ff0000";
                    }
                    msg.style.display = 'block';
                    if(isClick && hintsCollected >= TARGET_HINTS) nextLevel();
                    break;
                }
            }
            if(!found) msg.style.display = 'none';
        }

        function openQuiz(boxMesh) {
            activeQuizBox = boxMesh;
            const q = currentRoomQuizDeck.pop(); 
            if(!q) return; 

            document.getElementById('quiz-subject').innerText = `[${subjects[currentSubjectIndex]}] 문제`;
            document.getElementById('quiz-text').innerText = q.q;
            
            const optsDiv = document.getElementById('quiz-options');
            optsDiv.innerHTML = '';
            q.o.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = 'quiz-btn';
                btn.innerText = `${idx+1}. ${opt}`;
                btn.onclick = () => solveQuiz(idx === q.a);
                optsDiv.appendChild(btn);
            });

            controls.unlock();
            document.getElementById('quiz-modal').style.display = 'block';
        }

        function solveQuiz(isCorrect) {
            document.getElementById('quiz-modal').style.display = 'none';
            controls.lock(); 

            if(isCorrect) {
                hintsCollected++;
                document.getElementById('hint-count').innerText = hintsCollected;
                playTone(600, 'sine', 0.2); 
                
                scene.remove(activeQuizBox);
                activeQuizBox.visible = false; 
                activeQuizBox.userData.type = 'solved';
                
                if(hintsCollected >= TARGET_HINTS) {
                    doorMesh.material.color.set(0x00ff00);
                    playTone(800, 'sine', 0.5); 
                }
            } else {
                playTone(100, 'sawtooth', 0.5); 
                // 틀린 문제는 다시 덱으로 (단, 생성기 함수를 호출할 수 없으므로 현재 덱 맨 뒤로 보냄)
                currentRoomQuizDeck.unshift(currentRoomQuizDeck[Math.floor(Math.random()*currentRoomQuizDeck.length)]); 
            }
        }

        function nextLevel() {
            currentSubjectIndex++;
            if(currentSubjectIndex >= subjects.length) {
                gameOver("축하합니다! 모든 악몽에서 탈출했습니다!", true);
            } else {
                while(scene.children.length > 0){ scene.remove(scene.children[0]); }
                initThree(); 
                loadRoom(roomOrder[currentSubjectIndex]);
                world.bodies = []; 
                initPhysics(); 
                loadRoom(roomOrder[currentSubjectIndex]); 
                timer += 180; 
            }
        }

        const clock = new THREE.Clock();

        function animate() {
            if(gameState !== 'PLAYING') return;
            requestAnimationFrame(animate);

            const dt = clock.getDelta();
            
            if (world) world.step(1/60, dt, 3);

            if(controls.isLocked) {
                const direction = new THREE.Vector3();
                camera.getWorldDirection(direction);
                direction.y = 0; 
                direction.normalize();

                const side = new THREE.Vector3();
                side.crossVectors(camera.up, direction).normalize(); 

                const inputVelocity = new THREE.Vector3();

                if(keyState['KeyW']) inputVelocity.add(direction); 
                if(keyState['KeyS']) inputVelocity.sub(direction); 
                if(keyState['KeyA']) inputVelocity.add(side);      
                if(keyState['KeyD']) inputVelocity.sub(side);      

                if (inputVelocity.length() > 0) inputVelocity.normalize();

                playerBody.velocity.x = inputVelocity.x * playerSpeed;
                playerBody.velocity.z = inputVelocity.z * playerSpeed;

                if(keyState['Space'] && canJump) {
                    playerBody.velocity.y = 15; 
                    canJump = false;
                }
                
                checkInteraction(false);
            } else {
                playerBody.velocity.x = 0;
                playerBody.velocity.z = 0;
            }

            if(camera) {
                camera.position.copy(playerBody.position);
                camera.position.y += 0.5;
            }

            updateEnemy(dt);
            updateSpikes(dt);

            if(enemyMesh && enemyBody) {
                enemyMesh.position.copy(enemyBody.position);
                enemyMesh.lookAt(playerBody.position.x, playerBody.position.y, playerBody.position.z);
            }

            if(renderer && scene && camera) renderer.render(scene, camera);
        }

        let attackCooldown = 0;

        function updateEnemy(dt) {
            const dir = new THREE.Vector3().subVectors(playerBody.position, enemyBody.position);
            const dist = dir.length();
            
            if(dist < 4.0) {
                gameOver("검은 형체에게 잡혔습니다...");
                return;
            }

            if (dist < 15.0 && attackCooldown <= 0) {
                shootSpikes();
                attackCooldown = 3.0; 
            }
            if (attackCooldown > 0) attackCooldown -= dt;

            dir.normalize();
            
            enemyBody.velocity.x = dir.x * enemySpeed;
            enemyBody.velocity.z = dir.z * enemySpeed;

            if(playerBody.position.y > enemyBody.position.y + 2 || Math.random() < 0.01) {
                if(Math.abs(enemyBody.velocity.y) < 0.1) {
                    enemyBody.velocity.y = 10;
                }
            }
        }

        function shootSpikes() {
            playSpikeSound();
            const spikeCount = 12;
            for(let i=0; i<spikeCount; i++) {
                const angle = (i / spikeCount) * Math.PI * 2;
                const dx = Math.cos(angle);
                const dz = Math.sin(angle);
                
                const geo = new THREE.ConeGeometry(0.2, 2, 8);
                geo.rotateX(Math.PI / 2); 
                const mat = new THREE.MeshBasicMaterial({ color: 0xff0000 });
                const mesh = new THREE.Mesh(geo, mat);
                
                mesh.position.copy(enemyBody.position);
                mesh.position.y += 1; 
                mesh.lookAt(mesh.position.x + dx, mesh.position.y, mesh.position.z + dz);
                
                scene.add(mesh);
                spikes.push({ mesh: mesh, dir: new THREE.Vector3(dx, 0, dz), life: 30.0, speed: 20.0 }); 
            }
        }

        function updateSpikes(dt) {
            for (let i = spikes.length - 1; i >= 0; i--) {
                const s = spikes[i];
                const moveDist = s.speed * dt;
                s.mesh.position.x += s.dir.x * moveDist;
                s.mesh.position.z += s.dir.z * moveDist;
                s.life -= moveDist; 

                const pDist = s.mesh.position.distanceTo(playerBody.position);
                if (pDist < 1.5) { 
                    gameOver("붉은 가시에 찔렸습니다...");
                    return;
                }

                if (s.life <= 0) {
                    scene.remove(s.mesh);
                    spikes.splice(i, 1);
                }
            }
        }

        function gameOver(msg, isClear = false) {
            gameState = isClear ? 'CLEAR' : 'GAMEOVER';
            document.getElementById('gameover-screen').style.display = 'flex';
            document.getElementById('gameover-msg').innerText = isClear ? "ESCAPE!" : "GAME OVER";
            document.getElementById('gameover-msg').style.color = isClear ? "#00ff00" : "red";
            document.getElementById('death-reason').innerText = msg;
            
            const btnGroup = document.querySelector('.btn-group');
            if (isClear) btnGroup.style.display = 'none'; 
            else btnGroup.style.display = 'flex';

            if(!isClear) playScream();
            
            controls.unlock();
        }

        window.addEventListener('resize', () => {
            if (!camera || !renderer) return; 
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>